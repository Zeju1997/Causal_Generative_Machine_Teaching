# Iterative Teaching by Data Hallucination

<div align="left">
	
[![arxiv-link](https://img.shields.io/badge/Paper-PDF-red?style=flat&logo=arXiv&logoColor=red)](https://arxiv.org/abs/2210.17467)
[![made-with-pytorch](https://img.shields.io/badge/Made%20with-PyTorch-brightgreen)](https://pytorch.org/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

</div>

***Table of Contents***: - <a href="#getting-started">Getting started</a> - <a href="#usage">Usage</a> - <a href="#citation">Citation</a> -

<!-- ABOUT THE PROJECT -->
## About The Project

This is the official github repository for our work [Iterative Teaching by Data Hallucination](https://arxiv.org/pdf/2210.17467.pdf).


We consider the problem of iterative machine teaching, where a teacher sequentially provides
examples based on the status of a learner under a discrete input space (i.e., a pool of finite samples), 
which greatly limits the teacher’s capability. To address this issue, we study iterative teaching under 
a continuous input space where the input example (i.e., image) can be either generated by solving an 
optimization problem or drawn directly from a continuous distribution. Specifically, we propose 
data hallucination teaching (DHT) where the teacher can generate input data intelligently based on labels, 
the learner’s status and the target concept. We study a number of challenging teaching setups 
(e.g., linear/neural learners in omniscient and black-box settings).


![Alt text](figures/framework.png?raw=true "Title")

<p align="right">(<a href="#readme-top">back to top</a>)</p>


<!-- GETTING STARTED -->
## Getting Started

This is an example of how you may give instructions on setting up your project locally.
To get a local copy up and running follow these simple example steps.

### Data

We evaluate our data hullucination teaching framework on common image classification data, including MNIST, CIFAR10 and CIFAR100.
Create a folder named `data` in the root directory and the datasets will be automatically downloaded to the repository first
time when the training is executed.

### Installation

_Below is an example of how you can instruct your audience on installing and setting up your app. This template doesn't rely on any external dependencies or services._

1. Clone the repo
   ```sh
   git clone https://github.com/Zeju1997/data_halucination_teaching.git
   ```
2. Install required packages
   ```sh
    conda create -n dht python=3.6
    conda activate dht
    conda install pytorch==1.10.0 torchvision==0.11.0 torchaudio==0.10.0 -c pytorch
    pip install imageio scikit-image scikit-learn matplotlib seaborn pyyaml easydict tensorboard tensorboardX tqdm mathutils==2.81.2 
   ```
3. Create the environment from the yml file
   ```sh
    conda env create -f environment.yml
   ```

<p align="right">(<a href="#readme-top">back to top</a>)</p>



<!-- USAGE EXAMPLES -->
## Usage

Using this repository to reproduce results from the paper is very straightforward, i.e., simply run the desired experiment
specifiying a suited dataset.


1. Run different teaching policy with the corresponding config file. Note, the config file should match the teaching policy!
   ```sh
   python train.py --teaching_policy='omniscient_unrolled' --config='mnist'
   ```

<p align="right">(<a href="#readme-top">back to top</a>)</p>


<!-- LICENSE -->
## License

Distributed under the MIT License. See `LICENSE.txt` for more information.

<p align="right">(<a href="#readme-top">back to top</a>)</p>

<!-- CITATION -->
## Citation
  ```bibtex
  @InProceedings{Qiu2023DHT,
      title={Iterative Teaching by Data Hallucination},
      author={Qiu, Zeju and Liu, Weiyang and Xiao, Tim Z and Liu, Zhen 
        and Bhatt, Umang and Luo, Yucen and Weller, Adrian and Schölkopf, Bernhard},
      booktitle = {AISTATS},
      year={2023}
  }
  ```

<p align="right">(<a href="#readme-top">back to top</a>)</p>

<!-- ACKNOWLEDGMENTS -->
## Acknowledgments

Our repository is built upon the following projects:

* [Iterative Machine Teaching](https://github.com/Ipsedo/IterativeMachineTeaching)

<p align="right">(<a href="#readme-top">back to top</a>)</p>
